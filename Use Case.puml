@startuml
!theme plain
left to right direction
skinparam defaultFontSize 32

actor "Користувач" as User

actor "TFLite Model" as TFLiteModel
actor "WeatherAPI Service" as WeatherAPI
actor "GoogleMapsAPI Service" as GoogleMapsAPI
actor "Firebase" as Firebase

rectangle PlantyAI {

package " " {
(Діагностика хвороби рослини) as UC1
(Перегляд історії діагностик) as UC2
(Перегляд довідника рослин) as UC4
(Перегляд погоди) as UC8
(Перегляд карти діагностик) as UC9
(Керування налаштуваннями) as UC10
(Перегляд обраного) as UC7
}

'--- Діагностика рослин
(Вибір джерела зображення) as UC1_1
(Класифікація зображення) as UC1_2
(Перегляд деталей діагностики) as UC3
(Збереження результатів локально) as UC1_4
(Додавання геолокації до результатів) as UC1_5
(Завантаження результатів на Firebase) as UC1_6

User -- UC1
UC1 ..> UC1_1 : <<include>>
UC1 ..> UC1_2 : <<include>>
UC1 ..> UC3: <<include>>
UC1 ..> UC1_4 : <<include>>
UC1 <.. UC1_5 : <<extend>>
UC1 <.. UC1_6 : <<extend>>

UC1_1 <|-- (Фотографування камерою)
UC1_1 <|-- (Вибір зображення з галереї)
UC1_1 <|-- (Вибір зображення з файлів)

'--- Історія та зворотний зв'язок
(Пошук в історії) as UC2_1
(Відображення місцезнаходження на карті) as UC3_1
(Поширення результату) as UC3_2
(Надсилання зворотного зв’язку) as UC3_3

User -- UC2
UC2 <.. UC2_1 : <<extend>>
UC2 ..> UC3 : <<include>>
UC3 <.. UC3_1 : <<extend>>
UC3 <.. UC3_2 : <<extend>>
UC3 <.. UC3_3 : <<extend>>

'--- Довідник рослин і хвороб
(Пошук рослини в довіднику) as UC4_1
(Перегляд деталей рослини) as UC5
(Керування обраним) as UC5_1
(Перегляд деталей хвороби) as UC6

User -- UC4
UC4 <.. UC4_1 : <<extend>>
UC4 ..> UC5 : <<include>>
UC5 <.. UC5_1 : <<extend>>
UC5 ..> UC6 : <<include>>
UC6 <. UC5_1 : <<extend>>
UC3 ..> UC5 : <<include>>
UC3 ..> UC6 : <<include>>

'--- Обране
(Пошук в обраному) as UC7_1

User -- UC7
UC7 <.. UC7_1 : <<extend>>
UC7 ..> UC5 : <<include>>
UC7 ..> UC6 : <<include>>

'--- Додаткові сервіси
(Отримання даних про погоду) as UC8_1
(Відображення маркерів на карті) as UC9_2

User -- UC8
UC8 ..> UC8_1 : <<include>>
UC8_1 ---- WeatherAPI

UC9_2 -- GoogleMapsAPI
UC3_1 ..> UC9_2 : <<include>>
User -- UC9
UC9 ..> UC9_2 : <<include>>

'--- Налаштування та інфо
(Зміна дозволу на завантаження) as UC10_1
(Зміна дозволу на геолокацію) as UC10_2
(Очищення історії діагностик) as UC10_3

User -- UC10
UC10 ..> UC10_1 : <<include>>
UC10 ..> UC10_2 : <<include>>
UC10 ..> UC10_3 : <<include>>

'--- Системні внутрішні зв'язки
UC1_2 --down-- TFLiteModel
UC1_6 --- Firebase
UC3_3 --- Firebase
}
@enduml